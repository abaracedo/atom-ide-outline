{"version":3,"file":"main.js","sources":["../src/utils.ts","../src/outlineView.ts","../node_modules/atom-ide-base/src-commons-atom/ProviderRegistry.ts","../src/statuses.ts","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/now.js","../node_modules/lodash/_trimmedEndIndex.js","../node_modules/lodash/_baseTrim.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isSymbol.js","../node_modules/lodash/toNumber.js","../node_modules/lodash/debounce.js","../src/main.ts"],"sourcesContent":["import type { Dock } from \"atom\"\n\n/** A function to detect if an item (view) is visible in Atom */\nexport function isItemVisible(item: object) {\n  const paneContainer = atom.workspace.paneContainerForItem(item)\n  if (paneContainer === undefined) {\n    return false\n  }\n  if (typeof (paneContainer as any).isVisible === \"function\") {\n    return (paneContainer as Dock).isVisible()\n  } else {\n    return true\n  }\n}\n\n/** Throw an Error using atom notifications */\nexport function notifyError(e: Error) {\n  atom.notifications.addError(e.name, {\n    stack: e.stack,\n    detail: e.message,\n  })\n}\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { TextEditor, CursorPositionChangedEvent } from \"atom\"\nimport { OutlineTree } from \"atom-ide-base\"\nimport { isItemVisible } from \"./utils\"\n\nexport class OutlineView {\n  public element: HTMLDivElement\n  private pointToElementsMap = new Map<number, Array<HTMLLIElement>>() // TODO Point to element\n  private focusedElms: HTMLElement[] | undefined // cache for focused elements\n\n  constructor() {\n    this.element = document.createElement(\"div\")\n    this.element.classList.add(\"outline-view\")\n  }\n\n  destroy() {\n    this.element.remove()\n  }\n\n  getElement() {\n    return this.element\n  }\n\n  getTitle() {\n    return \"Outline\"\n  }\n\n  getIconName() {\n    return \"list-unordered\"\n  }\n\n  setOutline(outlineTree: OutlineTree[], editor: TextEditor, isLarge: boolean) {\n    const outlineViewElement = this.clearOutline()\n\n    if (isLarge) {\n      const largeFileElement = document.createElement(\"div\")\n      largeFileElement.innerHTML = `\n        <span style = \"\n          font-size: var(--editor-font-size);\n          font-family: var(--editor-font-family);\n          line-height: var(--editor-line-height);\n          color: #71844c;\n        \"\n        >Large file mode</span>\n      `\n      outlineViewElement.appendChild(largeFileElement)\n    }\n\n    const outlineRoot = document.createElement(\"ul\")\n    addOutlineEntries(\n      outlineRoot,\n      outlineTree,\n      editor,\n      this.pointToElementsMap,\n      /* foldInItially */ isLarge || atom.config.get(\"atom-ide-outline.foldInitially\")\n    )\n    outlineViewElement.appendChild(outlineRoot)\n  }\n\n  clearOutline() {\n    const outlineViewElement = this.getElement()\n    outlineViewElement.innerHTML = \"\"\n    return outlineViewElement\n  }\n\n  presentStatus(status: { title: string; description: string }) {\n    this.clearOutline()\n\n    const statusElement = status && generateStatusElement(status)\n\n    if (statusElement) {\n      const outlineViewElement = this.getElement()\n      outlineViewElement.appendChild(statusElement)\n    }\n  }\n\n  // callback for scrolling and highlighting the element that the cursor is on\n  selectAtCursorLine(newBufferPosition: CursorPositionChangedEvent[\"newBufferPosition\"]) {\n    // skip if not visible\n    if (!this.isVisible()) {\n      return\n    }\n\n    if (clicked) {\n      // do not scroll when the cursor has moved to a click on the outline entry\n      clicked = false\n      return\n    }\n\n    // TIME: ~0.2-0.3ms\n    // TODO use range of start and end instead of just the line number\n\n    // remove old cursorOn attribue\n    if (this.focusedElms !== undefined) {\n      for (const elm of this.focusedElms) {\n        elm.toggleAttribute(\"cursorOn\", false)\n      }\n    }\n\n    // add new cursorOn attribue\n    const cursorPoint = newBufferPosition.row\n    this.focusedElms = this.pointToElementsMap.get(cursorPoint)\n\n    if (this.focusedElms !== undefined) {\n      for (const elm of this.focusedElms) {\n        elm.toggleAttribute(\"cursorOn\", true)\n        elm.scrollIntoView({\n          block: \"center\", // scroll until the entry is in the center of outline\n        })\n      }\n    }\n  }\n\n  isVisible() {\n    return isItemVisible(this)\n  }\n}\n\nfunction generateStatusElement(status: { title: string; description: string }) {\n  const element = document.createElement(\"div\")\n  element.className = \"status\"\n\n  const { title = \"\", description = \"\" } = status\n  element.innerHTML = `<h1>${title}</h1>\n  <span>${description}</span>`\n\n  return element\n}\n\nlet clicked: boolean = false // used to prevent scrolling in the outline list when an entry is clicked\n\nfunction addOutlineEntries(\n  parent: HTMLUListElement,\n  entries: OutlineTree[],\n  editor: TextEditor,\n  pointToElementsMap: Map<number, Array<HTMLLIElement>>,\n  isLarge: boolean,\n  level = 0\n) {\n  // NOTE: this function is called multiple times with each update in an editor!\n  // a few of the calls is slow ~1-100ms\n\n  // calculate indent length\n  const tabLength = editor.getTabLength()\n  const indentRatio = 16 * (typeof tabLength === \"number\" ? tabLength : 4)\n\n  // sort entries\n  // TIME 0.1ms\n  if (atom.config.get(\"atom-ide-outline.sortEntries\")) {\n    entries.sort((e1: OutlineTree, e2: OutlineTree) => {\n      const rowCompare = e1.startPosition.row - e2.startPosition.row\n      if (rowCompare === 0) {\n        // compare based on column if on the same row\n        return e1.startPosition.column - e1.startPosition.column\n      }\n      return rowCompare\n    })\n  }\n\n  for (const item of entries) {\n    const symbol = document.createElement(\"li\")\n\n    // symbol.setAttribute(\"level\", `${level}`); // store level in the element\n\n    // Hold an entry in a dedicated element to prevent hover conflicts - hover over an <li> tag would be cought by a parent <li>\n    // TIME: ~0-0.1ms\n    const labelElement = document.createElement(\"span\")\n    labelElement.innerText = (item.representativeName || item.plainText) ?? \"\"\n\n    labelElement.prepend(/* iconElement */ getIcon(item?.icon, item?.kind))\n\n    symbol.appendChild(labelElement)\n\n    // update start position => elements map\n    // TIME: 0-0.2ms\n    const elms = pointToElementsMap.get(item.startPosition.row)\n    if (elms !== undefined) {\n      elms.push(symbol)\n      pointToElementsMap.set(item.startPosition.row, elms)\n    } else {\n      pointToElementsMap.set(item.startPosition.row, [symbol])\n    }\n\n    // Cursor reposition on click\n    // TIME: 0-0.1ms\n    symbol.addEventListener(\n      \"click\",\n      () => {\n        const editorPane = atom.workspace.paneForItem(editor)\n        if (!editorPane) {\n          return\n        }\n        editorPane.activate()\n\n        editor.getCursors()[0].setBufferPosition(item.startPosition, {\n          autoscroll: true,\n        })\n\n        clicked = true\n      },\n      { passive: true }\n    )\n\n    if (/* hasChildren */ item.children == null || item.children[0] == null) {\n      // indentation\n      labelElement.style.paddingLeft = level !== 0 ? `${indentRatio * level}px` : `${foldButtonWidth}px`\n    } else {\n      // indentation\n      // compensate for the fold button\n      labelElement.style.paddingLeft = level !== 0 ? `${indentRatio * level - foldButtonWidth}px` : `0px`\n\n      // create Child elements\n      // TIME 0-0.2ms\n      const childrenList = document.createElement(\"ul\")\n      childrenList.addEventListener(\"click\", (event) => event.stopPropagation(), { passive: true })\n      symbol.appendChild(childrenList)\n\n      // fold Button\n      const foldButton = createFoldButton(childrenList, isLarge)\n      labelElement.prepend(foldButton)\n\n      // add children to outline\n      // TIME: last one of each batch is slower 0-20ms\n      addOutlineEntries(childrenList, item.children, editor, pointToElementsMap, isLarge, level + 1)\n    }\n\n    // TIME: <0.1ms\n    parent.appendChild(symbol)\n  }\n}\n\nfunction getIcon(iconType?: string, kindType?: string) {\n  // LSP specification: https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocument_documentSymbol\n  // atom-languageclient mapping: https://github.com/atom/atom-languageclient/blob/485bb9d706b422456640c9070eee456ef2cf09c0/lib/adapters/outline-view-adapter.ts#L270\n\n  const iconElement = document.createElement(\"span\")\n  iconElement.classList.add(\"outline-icon\")\n\n  // if iconType given instead\n  if (kindType == undefined && iconType != undefined) {\n    kindType = iconType\n  }\n\n  let type: string = \"â€¢\"\n  if (typeof kindType === \"string\" && kindType.length > 0) {\n    let kindClass: string\n    // hasKind\n    if (kindType.indexOf(\"type-\") === 0) {\n      // supplied with type-...\n      kindClass = `${kindType}`\n      type = kindType.replace(\"type-\", \"\")\n    } else {\n      // supplied without type-\n      kindClass = `type-${kindType}`\n      type = kindType\n    }\n    iconElement.classList.add(kindClass)\n  }\n\n  iconElement.innerHTML = `<span>${type.substring(0, 3)}</span>`\n\n  return iconElement\n}\n\nconst foldButtonWidth = 20\n\nfunction createFoldButton(childrenList: HTMLUListElement, foldInitially: boolean) {\n  // TIME: ~0.1-0.5ms\n  // fold button\n  const foldButton = document.createElement(\"button\")\n\n  if (foldInitially) {\n    // collapse in large files by default\n    childrenList.hidden = true\n    foldButton.classList.add(\"outline-fold-btn\", \"collapsed\")\n  } else {\n    foldButton.classList.add(\"outline-fold-btn\", \"expanded\")\n  }\n\n  // fold listener\n  foldButton.addEventListener(\n    \"click\",\n    (event) => {\n      childrenList.hidden = !childrenList.hidden\n      if (childrenList.hidden) {\n        foldButton.classList.remove(\"expanded\")\n        foldButton.classList.add(\"collapsed\")\n      } else {\n        foldButton.classList.remove(\"collapsed\")\n        foldButton.classList.add(\"expanded\")\n      }\n      event.stopPropagation()\n    },\n    { passive: true }\n  )\n  return foldButton\n}\n","import { Disposable, TextEditor } from \"atom\"\nimport { Provider as ProviderTypes, BusySignalProvider, FindReferencesProvider } from \"../types-packages/main.d\"\n\nexport class ProviderRegistry<Provider extends Exclude<ProviderTypes, BusySignalProvider | FindReferencesProvider>> {\n  private providers: Array<Provider>\n\n  constructor() {\n    this.providers = []\n  }\n\n  addProvider(provider: Provider): Disposable {\n    const index = this.providers.findIndex((p) => provider.priority > p.priority)\n    if (index === -1) {\n      this.providers.push(provider)\n    } else {\n      this.providers.splice(index, 0, provider)\n    }\n    return new Disposable(() => {\n      this.removeProvider(provider)\n    })\n  }\n\n  removeProvider(provider: Provider): void {\n    const index = this.providers.indexOf(provider)\n    if (index !== -1) {\n      this.providers.splice(index, 1)\n    }\n  }\n\n  // TODO deprecate since there can be N providers.\n  getProviderForEditor(editor: TextEditor): Provider | null {\n    const grammar = editor.getGrammar().scopeName\n    return this.findProvider(grammar)\n  }\n\n  // TODO create an ordering or priority aware util to prefer instead.\n  getAllProvidersForEditor(editor: TextEditor): Iterable<Provider> {\n    const grammar = editor.getGrammar().scopeName\n    return this.findAllProviders(grammar)\n  }\n\n  findProvider(grammar: string): Provider | null {\n    for (const provider of this.findAllProviders(grammar)) {\n      return provider\n    }\n    return null\n  }\n\n  /**\n   * Iterates over all providers matching the grammar, in priority order.\n   */\n  *findAllProviders(grammar: string): Iterable<Provider> {\n    for (const provider of this.providers) {\n      if (provider.grammarScopes == null || provider.grammarScopes.indexOf(grammar) !== -1) {\n        yield provider\n      }\n    }\n  }\n}\n","export const statuses = {\n  noEditor: {\n    title: \"Outline is unavailable.\",\n    description: \"Open a text editor.\",\n  },\n  noProvider: {\n    title: \"Provider is unavailable\",\n    description:\n      \"Looks like a provider for this type of file is not available. Check if a relevant IDE language package is installed and has outline support, or try adding one from Atom's package registry (e.g.: atom-ide-javascript, atom-typescript, ide-python, ide-rust, ide-css, ide-json).\",\n  },\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","import { CompositeDisposable, TextEditor } from \"atom\"\nimport { OutlineView } from \"./outlineView\"\nimport { OutlineProvider } from \"atom-ide-base\"\nimport { ProviderRegistry } from \"atom-ide-base/commons-atom/ProviderRegistry\"\nimport { notifyError } from \"./utils\"\n\nexport { statuses } from \"./statuses\" // for spec\nimport { statuses } from \"./statuses\"\nimport debounce from \"lodash/debounce\"\n\nconst subscriptions = new CompositeDisposable()\n\nlet view: OutlineView | undefined\nexport const outlineProviderRegistry = new ProviderRegistry<OutlineProvider>()\n\n// let busySignalProvider: BusySignalProvider | undefined // service might be consumed late\n\nexport function activate() {\n  addCommands()\n  addObservers()\n  if (atom.config.get(\"atom-ide-outline.initialDisplay\")) {\n    // initially show outline pane\n    toggleOutlineView().catch((e) => {\n      notifyError(e)\n    })\n  }\n}\n\nexport function deactivate() {\n  onDidCompositeDisposable?.dispose?.()\n  subscriptions.dispose()\n  view?.destroy()\n  view = undefined\n}\n\n// export function consumeSignal(registry: BusySignalRegistry) {\n//   busySignalProvider = registry.create()\n//   subscriptions.add(busySignalProvider)\n// }\n\nexport async function consumeOutlineProvider(provider: OutlineProvider) {\n  subscriptions.add(/*  providerRegistryEntry */ outlineProviderRegistry.addProvider(provider))\n\n  // Generate (try) an outline after obtaining a provider\n  await getOutline()\n}\n\nfunction addCommands() {\n  subscriptions.add(\n    /* outlineToggle */ atom.commands.add(\"atom-workspace\", \"outline:toggle\", toggleOutlineView),\n    /* revealCursor */ atom.commands.add(\"atom-workspace\", \"outline:reveal-cursor\", revealCursor)\n  )\n}\n\nconst longLineLength = atom.config.get(\"linter-ui-default.longLineLength\") || 4000\nconst largeFileLineCount = atom.config.get(\"linter-ui-default.largeFileLineCount\") / 6 || 3000 // minimum number of lines to trigger large file optimizations\nfunction lineCountIfLarge(editor: TextEditor) {\n  // @ts-ignore\n  if (editor.largeFileMode) {\n    return 20000\n  }\n  const lineCount = editor.getLineCount()\n  if (lineCount >= largeFileLineCount) {\n    return lineCount\n  } else {\n    const buffer = editor.getBuffer()\n    for (let i = 0, len = lineCount; i < len; i++) {\n      if (buffer.lineLengthForRow(i) > longLineLength) {\n        return longLineLength\n      }\n    }\n    return 0 // small file\n  }\n}\n\n// disposables returned inside the oberservers\nlet onDidCompositeDisposable: CompositeDisposable | null\n\nfunction addObservers() {\n  onDidCompositeDisposable = new CompositeDisposable()\n  const activeTextEditorObserver = atom.workspace.observeActiveTextEditor(editorChanged)\n  subscriptions.add(activeTextEditorObserver)\n}\n\nasync function editorChanged(editor?: TextEditor) {\n  if (editor === undefined) {\n    return\n  }\n  // dispose the old subscriptions\n  onDidCompositeDisposable?.dispose?.()\n\n  await getOutline(editor) // initial outline\n\n  const lineCount = lineCountIfLarge(editor as TextEditor)\n  // How long to wait for the new changes before updating the outline.\n  // A high number will increase the responsiveness of the text editor in large files.\n  const updateDebounceTime = Math.max(lineCount / 5, 300) // 1/5 of the line count\n\n  const doubouncedGetOutline = debounce(getOutline as (textEditor: TextEditor) => Promise<void>, updateDebounceTime)\n\n  onDidCompositeDisposable!.add(\n    // update the outline if editor stops changing\n    editor.onDidStopChanging(async () => {\n      await doubouncedGetOutline(editor)\n    }),\n\n    // clean up if the editor editor is closed\n    editor.onDidDestroy(() => {\n      setStatus(\"noEditor\")\n    })\n  )\n}\n\nexport function revealCursor() {\n  const editor = atom.workspace.getActiveTextEditor()\n  if (editor === undefined) {\n    return\n  }\n\n  // following cursor disposable\n  if (view !== undefined) {\n    view.selectAtCursorLine(editor.getCursorBufferPosition())\n  }\n}\n\nexport async function toggleOutlineView() {\n  if (view === undefined) {\n    view = new OutlineView() // create outline pane\n  }\n  const outlinePane = atom.workspace.paneForItem(view)\n  if (outlinePane) {\n    outlinePane.destroyItem(view)\n    return\n  }\n\n  const rightDock = atom.workspace.getRightDock()\n  const [pane] = rightDock.getPanes()\n\n  pane.addItem(view)\n  pane.activateItem(view)\n\n  rightDock.show()\n\n  // Trigger an editor change whenever an outline is toggeled.\n  try {\n    await editorChanged(atom.workspace.getActiveTextEditor())\n  } catch (e) {\n    notifyError(e)\n  }\n}\n\nexport async function getOutline(editor = atom.workspace.getActiveTextEditor()) {\n  if (view === undefined) {\n    view = new OutlineView() // create outline pane\n  }\n  // if outline is not visible return\n  if (!view.isVisible()) {\n    return\n  }\n  // editor\n  if (editor === undefined) {\n    return setStatus(\"noEditor\")\n  }\n\n  // provider\n  const provider = outlineProviderRegistry.getProviderForEditor(editor)\n\n  if (!provider) {\n    return setStatus(\"noProvider\")\n  }\n\n  // const target = editor.getPath()\n\n  // const busySignalID = `Outline: ${target}`\n  // // @ts-ignore\n  // busySignalProvider?.add(busySignalID, { onlyForFile: target })\n\n  const outline = await provider.getOutline(editor)\n  view.setOutline(outline?.outlineTrees ?? [], editor, Boolean(lineCountIfLarge(editor as TextEditor)))\n\n  // busySignalProvider?.remove(busySignalID)\n}\n\nexport function setStatus(id: \"noEditor\" | \"noProvider\") {\n  view?.presentStatus(statuses[id])\n}\n\nexport { default as config } from \"./config.json\"\n"],"names":["notifyError","e","atom","notifications","addError","name","stack","detail","message","OutlineView","[object Object]","this","Map","element","document","createElement","classList","add","remove","outlineTree","editor","isLarge","outlineViewElement","clearOutline","largeFileElement","innerHTML","appendChild","outlineRoot","addOutlineEntries","pointToElementsMap","config","get","getElement","status","statusElement","className","title","description","generateStatusElement","newBufferPosition","isVisible","clicked","undefined","focusedElms","elm","toggleAttribute","cursorPoint","row","scrollIntoView","block","item","paneContainer","workspace","paneContainerForItem","isItemVisible","parent","entries","level","tabLength","getTabLength","indentRatio","sort","e1","e2","rowCompare","startPosition","column","symbol","labelElement","innerText","representativeName","plainText","prepend","getIcon","icon","kind","elms","push","set","addEventListener","editorPane","paneForItem","activate","getCursors","setBufferPosition","autoscroll","passive","children","style","paddingLeft","foldButtonWidth","childrenList","event","stopPropagation","foldButton","createFoldButton","iconType","kindType","iconElement","type","length","kindClass","indexOf","replace","substring","foldInitially","hidden","exports","providers","provider","index","findIndex","p","priority","splice","atom_1","removeProvider","grammar","getGrammar","scopeName","findProvider","findAllProviders","grammarScopes","statuses","noEditor","noProvider","value","global","Object","freeSelf","self","freeGlobal","Function","root","Date","now","reWhitespace","string","test","charAt","reTrimStart","slice","trimmedEndIndex","Symbol","objectProto","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","toStringTag","isOwn","call","tag","unmasked","result","getRawTag","objectToString","isObjectLike","baseGetTag","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","isSymbol","isObject","other","valueOf","baseTrim","isBinary","nativeMax","Math","max","nativeMin","min","func","wait","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","apply","leadingEdge","setTimeout","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","arguments","clearTimeout","toNumber","cancel","flush","subscriptions","CompositeDisposable","view","outlineProviderRegistry","ProviderRegistry","longLineLength","largeFileLineCount","lineCountIfLarge","largeFileMode","lineCount","getLineCount","buffer","getBuffer","i","len","lineLengthForRow","onDidCompositeDisposable","async","editorChanged","dispose","getOutline","updateDebounceTime","doubouncedGetOutline","debounce","onDidStopChanging","onDidDestroy","setStatus","revealCursor","getActiveTextEditor","selectAtCursorLine","getCursorBufferPosition","toggleOutlineView","outlinePane","destroyItem","rightDock","getRightDock","pane","getPanes","addItem","activateItem","show","getProviderForEditor","outline","setOutline","outlineTrees","Boolean","id","presentStatus","commands","activeTextEditorObserver","observeActiveTextEditor","addObservers","catch","addProvider","destroy"],"mappings":"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"}